<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="/buyRentArticle.css" />
    <title>Buy/Rent Article Page</title>

    <!-- Google Maps API -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAK4H-GJN8NesqK6OG9LEC5k7mZ1Y3dwZE&callback=initMap&libraries=places"></script>

    <!-- Handlebars -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.8/handlebars.min.js" 
        integrity="sha512-E1dSFxg+wsfJ4HKjutk/WaCzK7S2wv1POn1RRPGh8ZK+ag9l244Vqxji3r6wgz9YBf6+vhQEYJZpSjqWFPg9gg==" 
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>

    <header>
        <div class="header-container">
            <div class="finder-logo">
                <a href="/"><img class="logo" src="/logo3.jpg" alt="NextDoorSG logo"></a>
            </div>
            <div class="nav-link-container">
                <div class="nav-links">
                    <a href="/">Home</a>
                    <a href="/buyRentHome">Buy/rent</a>
                    <a href="/sellerHome">Sell</a>
                    <a href="/projectHome">New projects</a>
                    <a href="/tools">Tools</a>
                    <a href="#">Find agent</a>
                </div>
            </div>
            <div class="login">
                <a href="/login">Login</a>
            </div>
        </div>
    </header>

    <div class="article-container">
        <div class="article-contents">
            <div class="article-img">
                <img src="<%= article.image_path %>" alt="Property Image" />
            </div>

            <div class="article-description">
                <h1><%= article.title %></h1>
                <h3>Home Description:</h3>
                <p><%= article.description %></p>
                <h3>Home Insights:</h3>
                <p><%= article.insight %></p>
            </div>

            <div class="article-button">
                <div class="article-button-row">
                    <form action="/" method="GET">
                        <button type="submit">Shortlist</button>
                    </form>
                    <form action="/" method="GET">
                        <button type="submit">Share</button>
                    </form>
                </div>
                <div class="article-seller-info">
                    <p><strong>Seller Name:</strong> <%= article.sellerName %></p>
                    <p><%= article.sellerDetails %></p>
                </div>

                <div class="article-button-row">
                  <form action="/callDisplay/<%= article.id %>" method="GET">
                    <button type="submit">Call</button>
                  </form>
              
                  <form action="/" method="GET">
                    <button type="submit">Whatapp</button>
                  </form>
                </div>
            </div>

            <!-- Google Maps Section -->
            <div class="article-location">
                <p><strong>House Location:</strong> <%= article.location %></p>
                <h3>Interactive Map</h3>
                <div id="map" ></div>
            </div>

            <div class="article-fac">
                <h3>Home Amenities:</h3>
                <p><%= article.amenities %></p>
                <h3>Home Facilities:</h3>
                <p><%= article.facilities %></p>
            </div>
        </div>
    </div>

    <div class="recheader">
        <h3>Reccommended Articles</h3>
    </div>

    <div class="RecommandationsArticleContainer">
        <div class="RecommandContainer" id="recarticle-container">
            <script id="recommandationsTemplate" type="text/x-handlebars-template">
                {{#each RecommandationArticles}}
                <div class="recarticle">
                    <div class="imgcontainer">
                        <a href="{{link}}"><img src="{{img}}" alt="{{altText}}" /></a>
                    </div>
                    <a href="{{link}}"><h3>{{title}}</h3></a>
                    <a href="{{link}}"><p>{{context}}</p></a>
                </div>
                {{/each}}
            </script>
        </div>
    </div>
    
    <br>

    <!-- Q&A section -->
    <div class="QAsectioncontainer">
      <div class="QAheader">
        <h2>FAQ</h2>
      </div>

      <div class="QA">
        <div class="QA-item">
          <div class="QA-item-header">What are the differences between the housing types in Singapore?</div>
          <div class="QA-item-body">
            <div class="QA-item-body-content">For a full, comprehensive guide on the different housing properties in Singapore, you can read about it <a href="https://www.propertyguru.com.sg/property-guides/the-different-types-of-housing-in-singapore-9916">here</a></div>
          </div>
        </div>

        <div class="QA-item">
          <div class="QA-item-header">What is the difference between a freehold and leasehold property in Singapore</div>
          <div class="QA-item-body">
            <div class="QA-item-body-content">Freehold properties grant owners indefinite ownership, meaning they can hold the property for generations without worrying about lease expiration. These properties tend to retain their value better and are generally more expensive due to their long-term security and desirability.<br><br>On the other hand, leasehold properties come with a fixed tenure, usually 99 years or, in some cases, 999 years. The shorter the remaining lease, the more the property may depreciate in value. When the lease expires, ownership reverts to the government unless it is renewed. Despite this limitation, leasehold properties are more affordable, making them attractive to buyers looking for a lower entry price.</div>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <div class="footer-container">
        <div class="footer-row">
          <h3>NextDoorSG</h3>
          <p>Follow us here:</p>
          <a href="#"><img src="https://img.icons8.com/ios/50/facebook--v1.png" alt="Facebook logo" ></a>
          <a href="#"><img src="https://img.icons8.com/ios/50/twitterx--v1.png" alt="X logo" ></i></a>
          <a href="#"><img src="https://img.icons8.com/ios/50/instagram-new--v1.png" alt="Insta logo" ></i></a>
          <a href="#"><img src="https://img.icons8.com/ios/50/youtube-play--v1.png" alt="Youtube logo" ></i></a>
        </div>
       
        <div class="footer-col">
          <ul>
            <li><a href="/projectHome">New Projects</a></li>
            <li><a href="/tools">Tools</a></li>
            <li><a href="#">Find Agents</a></li>
          </ul>
        </div>

        <div class="footer-col">
          <ul>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Contact Us</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Term of Service</a></li>
          </ul>
        </div>

        <div class="footer-col">
          <ul>
            <li><a href="#">Sitemap</a></li>
            <li><a href="#">Licenses</a></li>
            <li><a href="#">Mobile App</a></li>
            <li><a href="#">Term of Service</a></li>
          </ul>
        </div>
 
        <div class="footer-bottom">
          <p><small>&copy;NextDoorSG. All rights reserved. Images are for illustrative purposes</small></p>
          <p><small>Terms and conditions apply</small></p>
        </div>
      </div>
    </footer>

    <script>
      // handle bar for Recommandations
      document.addEventListener("DOMContentLoaded", function () {
        var recArr = {
          RecommandationArticles: [
            {
              link: "https://www.edgeprop.sg/property-news/are-ecs-still-good-buy",
              altText: "reccomended articles 1",
              img: "/sampleimages/reccoimage1.jpg",

              title: "Are ECs still a good buy?",
              context: "This article aims to explore if Executive Condominiums are still a good buy for homeowners in 2025",
              name: "Admin",
              date: "14/Sep/2025",
            },
            {
              link: "https://www.channelnewsasia.com/commentary/singapore-housing-prices-hdb-affordability-demographics-ageing-singles-low-birth-rates-4923326",
              altText: "reccomended articles 2",
              img: "/sampleimages/reccoimage2.jpg",

              title: "Will Singaporeâ€™s property prices always rise, or is that a myth?",
              context: "Exploring if increasing property prices are going to impact the current generation or is it all a ploy?",
              name: "Admin",
              date: "09/Nov/2025",
            },
            {
              link: "https://www.edgeprop.sg/property-news/three-bedroom-unit-watertown-going-24-mil",
              altText: "reccomended articles 3",
              img: "/sampleimages/reccoimage3.jpg",

              title: "Three-bedroom unit at Watertown going for $2.4 mil",
              context: "Come and explore a new record-breaking price for this property in Singapore!",
              name: "Admin",
              date: "14/Jun/2025",
            }
          ],
        };

        // Get the Handlebars template
        var recommandSource = document.getElementById("recommandationsTemplate").innerHTML;
        var recommandTemplate = Handlebars.compile(recommandSource);

        // Render the template with data
        var recommandArticles = recommandTemplate(recArr);

        // Append the rendered object to container
        document.querySelector("#recarticle-container").innerHTML =
        recommandArticles;
      });

      // Q&A js script //
      const QAItemHeaders = document.querySelectorAll(".QA-item-header");
      QAItemHeaders.forEach((QAItemHeader) => {
        QAItemHeader.addEventListener("click", (event) => {
          const currentActiveQAItemHeader = document.querySelector(
            ".QA-item-header.active"
          );
          if (
            currentActiveQAItemHeader &&
            currentActiveQAItemHeader !== QAItemHeader
          ) {
            currentActiveQAItemHeader.classList.toggle("active");
            currentActiveQAItemHeader.nextElementSibling.style.maxHeight = 0;
          }

          QAItemHeader.classList.toggle("active");
          const QAItemBody = QAItemHeader.nextElementSibling;
          if (QAItemHeader.classList.contains("active")) {
            QAItemBody.style.maxHeight = QAItemBody.scrollHeight + "px";
          } else {
            QAItemBody.style.maxHeight = 0;
          }
        });
      });
    </script>

<script>
  function initMap() {
      var location = "<%= article.location %>"; // Get user-inputted address
      console.log("Location from article.location:", location); // DEBUGGING LOG

      var geocoder = new google.maps.Geocoder();
      var mapOptions = {
          zoom: 15,
          center: { lat: 1.3521, lng: 103.8198 } // Default to Singapore
      };
      var map = new google.maps.Map(document.getElementById("map"), mapOptions);

      // Convert address into lat/lng using Geocoding API
      geocoder.geocode({ address: location }, function(results, status) {
          if (status === "OK") {
              var propertyLocation = results[0].geometry.location;
              map.setCenter(propertyLocation);

              new google.maps.Marker({
                  map: map,
                  position: propertyLocation,
                  title: "Property Location"
              });
              console.log("Geocoded location:", propertyLocation); // DEBUGGING LOG
          } else {
              console.error("Geocode failed:", status);
              alert("Could not find location: " + location);
          }
      });
  }

  // Ensure initMap is globally available for Google API callback
  window.initMap = initMap;
</script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAK4H-GJN8NesqK6OG9LEC5k7mZ1Y3dwZE&callback=initMap&libraries=places"></script>


  </body>
</html>
